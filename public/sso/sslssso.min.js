function Observable(){this.listen=function(t,n,e,o){var i,s;(i=this.listeners)||(i=this.listeners={}),(s=i[t])||(s=i[t]=[]),e=e||window,s.push({method:n,scope:e,context:o||e})},this.fireEvent=function(t,n,e){var o,i,s,a,c;if((o=this.listeners)&&(i=o[t])){for(s=0,a=i.length;s<a;s++)if(c=i[s],(void 0===e||e===c.context)&&!1===c.method.call(c.scope,this,t,n))return!1;return!0}}}function _getAPIKEY(){return _getMetaData("sso_smsc_apikey")?_getMetaData("sso_smsc_apikey"):"undefined"!=typeof ssls_accountId&&ssls_accountId?ssls_accountId:null}function _getMetaData(t){for(var n=document.getElementsByTagName("meta"),e=0;e<n.length;e++)if(n[e].getAttribute("name")==t)return n[e].getAttribute("content");return null}function displayLogin(){var t=_getAPIKEY(),n=document.domain;PopupCenter(""===n||void 0===n?"//sso.ufl.udn.vn/sso/authenticate/"+t+"/demo_html":"//sso.ufl.udn.vn/sso/authenticate/"+t+"/"+n,"xtf","450","600")}function PopupCenter(t,n,e,o){var i=void 0!=window.screenLeft?window.screenLeft:window.screenX,s=void 0!=window.screenTop?window.screenTop:window.screenY,a=(window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-e/2+i,c=(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-o/2+s,d=window.open(t,n,"scrollbars=yes, width="+e+", height="+o+", top="+c+", left="+a);window.focus&&d.focus()}sslssso=new sslssso;var console=window.console||{log:function(){}};function sslssso(){var DEFAULT_IFRAME_URI="html/sso.html",obs=new Observable,config={};function _getMeta(t){for(var n=document.getElementsByTagName("meta"),e=0;e<n.length;e++)if(n[e].getAttribute("name")==t)return n[e].getAttribute("content");return null}function _getAccountId(){return config.accountId?config.accountId:_getMeta("sso_smsc_apikey")?_getMeta("sso_smsc_apikey"):"undefined"!=typeof ssls_accountId&&ssls_accountId?ssls_accountId:null}function _getValidationUrl(){return config.validationUrl?config.validationUrl:_getMeta("ssls.validationUrl")?_getMeta("ssls.validationUrl"):"undefined"!=typeof ssls_validationUrl&&ssls_validationUrl?ssls_validationUrl:null}function _getValidate(){return config.validate?config.validate:_getMeta("ssls.validate")?_getMeta("ssls.validate"):null}this.listen=function(t,n,e,o){obs.listen(t,n,e,o)},this.logout=function(){postSSOMessage({action:"logout"},_getUrl())},this.login=function(t){postSSOMessage({action:"login",jwt:t},_getUrl())};var _getScriptURL=(Q=document.getElementsByTagName("script"),S=Q[Q.length-1],function(){return S.src}),Q,S;function _getIframeUrl(){var t=document.createElement("a");t.href=_getScriptURL();t.pathname.substring(0,t.pathname.lastIndexOf("/"));var n=t.protocol+"//"+t.host+"/"+DEFAULT_IFRAME_URI,e=document.location.origin,o=_getAccountId(),i=_getValidationUrl(),s=_getValidate();return n=n+"?domain="+e,o&&(n=n+"&accountId="+o),i&&(n=n+"&validationUrl="+i),null!=s&&(n=n+"&validate="+s),n}function _getUrl(){var t=document.createElement("a");return t.href=_getScriptURL(),t.protocol+"//"+t.host}function postSSOMessage(t,n){var e=document.getElementById("ssls.sso.iframe").contentWindow;window.attachEvent?e.postMessage(JSON.stringify(t),"*"):e.postMessage(t,_getUrl())}function dispatchEvent(t,n){obs.fireEvent(t,n)}function _listener(event){if(-1!=_getUrl().lastIndexOf(event.origin)){var data=event.data;event.data&&!event.data.action&&(data=eval("("+event.data+")")),data&&"sso.onlogout"==data.action?("function"==typeof onLogout&&onLogout(),dispatchEvent("sso.onlogout")):data&&"sso.onload"==data.action?("function"==typeof onLoad&&onLoad(),dispatchEvent("sso.onload")):data&&"sso.onidentification"==data.action&&("function"==typeof onIdentification&&onIdentification(data),dispatchEvent("sso.onidentification",data))}}function _init(){_getAccountId();window.addEventListener?addEventListener("message",_listener,!1):attachEvent("onmessage",_listener);var t=_getIframeUrl(),n=document.createElement("iframe");n.style.display="none",n.src=t,n.id="ssls.sso.iframe",document.body.appendChild(n)}function init(t){t&&(config=t)}window.addEventListener?window.addEventListener("load",_init,!1):window.attachEvent&&window.attachEvent("onload",_init)}